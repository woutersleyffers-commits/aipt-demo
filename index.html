<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIPT - AI Personal Trainer Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        form {
            display: flex;
            flex-direction: column;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        label {
            margin-top: 12px;
            font-weight: bold;
        }
        input, select {
            padding: 10px;
            margin-top: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }
        button {
            margin-top: 25px;
            padding: 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        #response {
            margin-top: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            white-space: pre-wrap;
            min-height: 150px;
        }
        hr {
            margin: 40px 0;
        }
        #chatSection {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <h1>AIPT: Your AI Personal Trainer</h1>
    <p style="text-align: center;">Enter your details below to get a personalized fitness & nutrition plan powered by AI!</p>
    
    <form id="userForm">
        <label for="name">Your Name:</label>
        <input type="text" id="name" placeholder="e.g. Wouter" required>
        
        <label for="age">Age:</label>
        <input type="number" id="age" min="18" max="100" required>
        
        <label for="gender">Gender:</label>
        <select id="gender" required>
            <option value="">Select...</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other / Prefer not to say</option>
        </select>
        
        <label for="weight">Current Weight (kg):</label>
        <input type="number" id="weight" min="40" max="200" step="0.1" required>
        
        <label for="height">Height (cm):</label>
        <input type="number" id="height" min="140" max="220" required>
        
        <label for="goal">Main Goal:</label>
        <select id="goal" required>
            <option value="">Select...</option>
            <option value="lose fat">Lose Fat (get leaner)</option>
            <option value="build muscle">Build Muscle</option>
            <option value="both">Recomp (lose fat + build muscle)</option>
        </select>
        
        <label for="experience">Training Experience:</label>
        <select id="experience" required>
            <option value="">Select...</option>
            <option value="beginner">Beginner (0-1 year consistent training)</option>
            <option value="intermediate">Intermediate (1-3 years)</option>
            <option value="advanced">Advanced (3+ years)</option>
        </select>
        
        <label for="diet">Dietary Preferences (optional):</label>
        <input type="text" id="diet" placeholder="e.g. Vegan, Keto, No dairy, None">
        
        <button type="submit">Generate My Personalized Plan</button>
    </form>
    
    <div id="response">Your AI-generated plan will appear here...</div>
    
    <hr>
    
    <div id="chatSection">
        <h2>Ask AIPT follow-up questions</h2>
        <p>After getting your plan, ask things like: "Make it vegan", "I'm sore â€” what now?", "Suggest a meal for 500 calories left".</p>
        <input type="text" id="chatInput" placeholder="Type your question here..." style="width: 100%; padding: 10px; margin-bottom: 10px;">
        <button id="chatButton">Send to AIPT</button>
        <div id="chatResponse" style="margin-top: 15px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; min-height: 100px;"></div>
    </div>

    <script src="https://js.puter.com/v2/"></script>
    <script>
        // === MAIN PLAN GENERATOR ===
        const form = document.getElementById('userForm');
        const responseDiv = document.getElementById('response');

        form.addEventListener('submit', async (event) => {
            event.preventDefault();

            const userData = {
                name: document.getElementById('name').value.trim() || 'Friend',
                age: document.getElementById('age').value,
                gender: document.getElementById('gender').value,
                weight: document.getElementById('weight').value,
                height: document.getElementById('height').value,
                goal: document.getElementById('goal').value,
                experience: document.getElementById('experience').value,
                diet: document.getElementById('diet').value.trim() || 'None'
            };

            const userPrompt = `
                User details:
                - Name: ${userData.name}
                - Age: ${userData.age}
                - Gender: ${userData.gender}
                - Weight: ${userData.weight} kg
                - Height: ${userData.height} cm
                - Goal: ${userData.goal}
                - Experience: ${userData.experience}
                - Dietary preferences: ${userData.diet}

                As AIPT, create a personalized starting plan including:
                - Estimated daily calories and macro split (protein/carbs/fats)
                - Simple 3x/week full-body strength training program (exercises, sets, reps)
                - 2-3 sample meal ideas fitting the macros and preferences
                - Quick motivational tips and next steps
                Keep it encouraging, clear, and under 600 words.
            `;

            const systemPrompt = `
                You are AIPT, a friendly, expert AI personal trainer helping users build their best physique (low fat, high muscle).
                Always use the user's name. Be motivational, positive, and practical.
                Structure your response with clear headings like:
                ## Your Daily Targets
                ## Your 3x/Week Workout Plan
                ## Sample Meals Today
                ## Quick Tips & Motivation
                Base advice on standard fitness science (e.g. TDEE estimates, progressive overload).
            `;

            responseDiv.innerHTML = '<strong>Generating your custom plan... (may take 10-30 seconds the first time)</strong>';

            try {
                const aiResponse = await puter.ai.chat(userPrompt, { system: systemPrompt });
                responseDiv.innerText = aiResponse;
            } catch (error) {
                responseDiv.innerHTML = `<strong>Error:</strong> ${error.message || 'Something went wrong. Check console for details.'}<br><br>Try refreshing the page or signing in at puter.com first.`;
                console.error('AIPT Error:', error);
            }
        });

        // === FOLLOW-UP CHAT ===
        const chatInput = document.getElementById('chatInput');
        const chatButton = document.getElementById('chatButton');
        const chatResponseDiv = document.getElementById('chatResponse');

        chatButton.addEventListener('click', async () => {
            const question = chatInput.value.trim();
            if (!question) return;

            chatResponseDiv.innerHTML = '<em>Thinking...</em>';

            try {
                const aiChatResponse = await puter.ai.chat(question, {
                    system: 'You are AIPT, the helpful AI trainer. Keep answers short, friendly, and directly related to fitness/nutrition. Use the user context if available from previous messages.'
                });
                chatResponseDiv.innerText = aiChatResponse;
                chatInput.value = '';
            } catch (error) {
                chatResponseDiv.innerHTML = `<strong>Error:</strong> ${error.message || 'Try again.'}`;
                console.error('Chat Error:', error);
            }
        });
    </script>
</body>
</html>
